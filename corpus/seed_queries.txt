-- Complete, syntactically correct SQL queries for YBFuzz corpus
-- All queries are guaranteed to be executable without syntax errors

-- Basic SELECT queries
SELECT COUNT(*) FROM information_schema.tables;
SELECT table_name, table_schema FROM information_schema.tables ORDER BY table_name;
SELECT DISTINCT table_type FROM information_schema.tables;
SELECT * FROM information_schema.columns LIMIT 10;

-- YugabyteDB-specific queries
SELECT * FROM pg_stat_activity WHERE state = 'active';
SELECT * FROM pg_stat_database WHERE datname = current_database();
SELECT * FROM pg_stat_user_tables ORDER BY n_tup_ins DESC LIMIT 5;

-- Complex queries with JOINs
SELECT t.table_name, c.column_name, c.data_type 
FROM information_schema.tables t 
JOIN information_schema.columns c ON t.table_name = c.table_name 
WHERE t.table_schema = 'public' 
ORDER BY t.table_name, c.ordinal_position;

-- Aggregation queries
SELECT table_schema, COUNT(*) as table_count 
FROM information_schema.tables 
GROUP BY table_schema 
ORDER BY table_count DESC;

-- Window function queries
SELECT table_name, table_schema, 
       ROW_NUMBER() OVER (PARTITION BY table_schema ORDER BY table_name) as rn
FROM information_schema.tables;

-- Subquery examples
SELECT table_name FROM information_schema.tables 
WHERE table_schema IN (
    SELECT DISTINCT table_schema FROM information_schema.tables 
    WHERE table_schema NOT IN ('information_schema', 'pg_catalog')
);

-- CTE (Common Table Expression) queries
WITH table_stats AS (
    SELECT table_schema, COUNT(*) as table_count
    FROM information_schema.tables
    GROUP BY table_schema
)
SELECT * FROM table_stats WHERE table_count > 0;

-- JSON operations (YugabyteDB supports JSONB)
SELECT '{"key": "value"}'::jsonb as json_data;
SELECT jsonb_build_object('table', table_name, 'schema', table_schema) as table_info
FROM information_schema.tables LIMIT 3;

-- Array operations
SELECT ARRAY[1, 2, 3, 4, 5] as numbers;
SELECT array_length(ARRAY[1, 2, 3], 1) as array_length;

-- String operations
SELECT table_name, LENGTH(table_name) as name_length 
FROM information_schema.tables 
WHERE table_name LIKE '%table%';

-- Date/time operations
SELECT CURRENT_DATE as today, CURRENT_TIMESTAMP as now;
SELECT NOW() + INTERVAL '1 day' as tomorrow;

-- Mathematical operations
SELECT 1 + 2 * 3 as calculation;
SELECT RANDOM() as random_number;

-- Transaction control
BEGIN;
SELECT COUNT(*) FROM information_schema.tables;
COMMIT;

-- DDL operations (safe ones)
CREATE TABLE IF NOT EXISTS test_table (id int, name text);
DROP TABLE IF EXISTS test_table;

-- Performance testing queries
SELECT * FROM information_schema.tables WHERE table_name ILIKE '%test%';
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';

-- YugabyteDB distributed features
SELECT * FROM pg_stat_activity WHERE backend_type = 'client backend';
SELECT * FROM pg_stat_bgwriter;

-- Complex nested queries
SELECT t.table_name, 
       (SELECT COUNT(*) FROM information_schema.columns c WHERE c.table_name = t.table_name) as column_count
FROM information_schema.tables t
WHERE t.table_schema = 'public'
ORDER BY column_count DESC;

-- Set operations
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'
UNION
SELECT table_name FROM information_schema.tables WHERE table_schema = 'information_schema';

-- Conditional logic
SELECT table_name, 
       CASE 
           WHEN table_schema = 'public' THEN 'User Table'
           WHEN table_schema = 'information_schema' THEN 'System Table'
           ELSE 'Other'
       END as table_type
FROM information_schema.tables;
